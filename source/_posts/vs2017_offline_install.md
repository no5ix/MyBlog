---
title: Visual Studio 2017 各版本安装包离线下载、安装全解析
date: 2019-12-08 18:08:55
tags:
- VS
categories:
- Misc
---


**. . .**<!-- more -->

原文地址 https://www.ithome.com/html/win10/297093.htm


关于 Visual Studio 2017 各版本安装包离线下载、更新和安装的方法以及通过已下载版本减少下载量的办法

微软最近发布了正式版 Visual Studio 2017 并公开了其下载方式，不过由于 VS2017 采用了新的模块化安装方案，所以微软官方并未提供 ISO 镜像，但是官方提供了如何进行离线下载的方案给需要进行离线安装的用户，只不过都是英文。本文将对官方指南中的一部分进行翻译（这里说一句：翻译的部分就是最基础的离线下载和安装方案，另外，即使如以前微软提供了安装镜像，也仅会包含 Visual Studio 的基本核心组件和部分官方扩展，而微软、安卓和苹果等平台的 SDK、模拟器和第三方扩展功能等会在用户选择后联网下载。而 VS2017 的离线包是包含所有可选项的）。好了，接下来将会分为四部分来叙述，分别是离线下载安装文件、离线安装 VS2017、更新离线文件包以及如何通过已下载版本来减少下载其它版本下载量的方法。  

**第一部分：离线下载安装文件**

这里描述是包括所有版本，截图以下载 VS2017 社区版为例：

①登入 VS 官网下载页面，选择需要的版本点击下载，下载页[点此进入](https://www.visualstudio.com/zh-hans/downloads/)。

②下载完成后，打开下载文件所在文件夹，[Windows 8.1](http://win8.ithome.com/) 及以上版本用户点击资源管理器上的文件 - 打开命令提示符 - 以管理员身份打开命令提示符；[Windows7](http://www.win7china.com/) 用户可在该文件夹空白处按住 Shift 键的情况下点击鼠标右键选择 “在此处打开命令窗口”。

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111252_335.jpg)

③根据自己下载的 VS2017 版本，在打开的命令提示符窗口输入下面对应的命令并点击回车，等待程序启动即会开始下载（以下命令用于下载完整版离线包，包含全功能以及全语言包，其中红色部分为下载文件存放路径，根据自身情况用户可自行更改）

**企业版**：

vs_enterprise.exe --layoutc:\vs2017offline

**专业版**：

vs_professional.exe --layoutc:\vs2017offline

**社区版**：

vs_community.exe --layoutc:\vs2017offline

![](https://img.ithome.com/newsuploadfiles/2017/03/20170310111501_3753.jpg)

如果需要下载单一语言的或其中某几种语言的离线文件，可采用以下命令：

企业版：vs_enterprise.exe --layout c:\vs2017offline --langzh-CN

专业版：vs_professional.exe --layout c:\vs2017offline --langzh-CN

社区版：vs_community.exe --layout c:\vs2017offline --langzh-CN

红色代码为语言参数，这里提供三种语言的参数供大家选择

英语（美国）：en-US

中文：zh-CN（简体），zh-TW（繁体）

日语：ja-JP

如果需要同时下载多种语言，可以在 --lang 后面连续加上多个语言代码参数，用空格间隔开就行，比如—lang en-US zh-CN ja-JP，那么就会同时下载英文、中文和日文语言包。

④如需更多语言包或者更多安装指令，请参考官方离线安装命令指南：[点此进入](https://docs.microsoft.com/en-us/visualstudio/install/use-command-line-parameters-to-install-visual-studio)。

⑤等待文件下载，不要关闭文件下载窗口，等所有文件下载完成后该窗口会自动关闭，下载过程中不要断电断网，也不要关闭窗口，当然，**如果断电断网或者关闭了下载窗口，没关系，输入命令重头来过，还是会继续下载的**。

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111308_663.jpg)

**第二部分：离线安装**

本部分以安装社区版为例，其他版本安装过程一样，只是**专业版和企业版需要激活授权**。

①打开刚刚存放离线文件的路径，比如 E:\vs2017offline，然后找到 certificates 文件夹并打开，依次安装该文件夹下的软件证书。双击证书并根据提示往下走就行了，实在懒得弄就一直下一步直到提示导入成功。

![](https://img.ithome.com/newsuploadfiles/2017/03/20170310111501_6735.jpg)

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111317_280.jpg)

②运行离线根目录下的安装程序，各版本位置如下：

企业版：离线文件存储文件夹 \ vs_Enterprise.exe

专业版：离线文件存储文件夹 \ vs_Professional.exe

社区版：离线文件存储文件夹 \ vs_Community.exe

③安装程序运行后，选择自己需要的模块和功能，确认所需后点击安装即可。顺便吐槽一下，**社区版全工作负荷、全组件以及全语言包选择后需要空间 93.85GB**，所以大家还是选择自己需要的安装就行了…… 另外，需要 Python 扩展支持的朋友，可以自己下载 Python 安装，或者安装完成后自行到扩展添加，官方安装文件对 Python 扩展的包含据说要等下次更新……

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111325_421.jpg)

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111332_744.jpg)

④等待安装完成即可使用了。

**第三部分：更新离线文件包**

这部分比较简单，步骤如下：

①当微软提示有版本更新后，到官网下载最新的在线安装执行文件，下载地址：[点此进入](https://www.visualstudio.com/zh-hans/downloads/)。

②按步骤执行本文第一部分下载离线安装文件的步骤，但是必须注意，**--layout 后的下载文件夹路径必须是旧版本离线文件存储的位置**（如果你之前下载好没移动过那就是之前的下载路径），执行命令后安装程序会扫描已有文件并下载更新文件和新增文件。

③更新完成后可再次执行离线文件夹根目录下的安装程序进行软件更新，或者 VS 中直接检查更新，更新新版本理论上无需重新导入证书除非有新证书被下载。

**第四部分：通过已下载版本减少其他版本离线下载量**

这部分也很简单，原理就是社区版、专业版和企业版有大多数组件其实是相同，如果用户想离线下载所有版本，那么没有那个必要，企业版包含了其它所有版本的组件，所以理论上用户只用下载企业版即可，安装时是可选择安装社区版、专业版或者企业版的。当然目前前面所述只是理论，毕竟我没试验，当然以下方法可以百分百保证需要的用户用最少的下载量完成下载所有版本的 VS2017。

如果你已经下载好了其中一版，均可进行如下操作：

①创建两个新文件夹，根据你自己的爱好重命名，**最好是英文名。**

②将已经下好的版本的所有文件都分别复制到这两个新文件夹中，并删除由之前下载程序下载在根目录下的六个文件。

![](https://img.ithome.com/newsuploadfiles/2017/03/20170310111501_7502.jpg)

③下载另外两个版本的安装程序，接下来就是重复第一部分的步骤，但是**命令行命令—layout 后的路径参数根据版本分别设置为你刚刚新建的那两个文件夹。**

④回车执行命令，程序会扫描和检查已经下载的组件，并现在自己版本对应的缺少的以及匹配的组件，不过**这部分大小不会超过 1GB，准确来说可能只有几十兆左右……**

⑤等待完成，反正不一会儿就好了，然后就可以收藏三个版本的离线包了。

⑥至于更新嘛，参见第三部分。

**第五部分：附加**

这部分呢是附加的一部分，信息是完全下载（包含全功能全语言包）的社区版和企业版的详细文件信息，以及他们的差集文件夹信息；最大的是企业版，最小的是企业版和社区版文件夹差集的信息。最后就是，各版本离线包里面至少含以下关键字的文件夹中的内容是完全一模一样的，就是：SDK、.NET、Xamarin、Unity、Cocos、Unreal、Linux、Mac、iOS、[Android](http://android.ithome.com/)、emulator…… 包含这些关键词的文件夹，大小合计应该超过 16GB 了……

![](https://img.ithome.com/newsuploadfiles/2017/3/20170310_111343_54.jpg)

![](https://img.ithome.com/newsuploadfiles/2017/03/20170310111502_3657.jpg)

![](https://img.ithome.com/newsuploadfiles/2017/03/20170310111502_0367.jpg)